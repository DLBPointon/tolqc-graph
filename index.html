<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>TolQC PacBio Stat-Graphs</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">

  <base href="/tolqc-graph/">

  <link rel="apple-touch-icon" href="icon.png">
  <!-- Place favicon.ico in the root directory -->

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css">

  <meta name="theme-color" content="#fafafa">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-2.4.2.min.js"></script>
  <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="https://cdn.anychart.com/releases/8.9.0/js/anychart-core.min.js"></script>
  <script src="https://cdn.anychart.com/releases/8.9.0/js/anychart-sunburst.min.js"></script>
  <script src="js/pb_yield_time.js"></script>
  <script src="js/pb_tolid_specific.js"></script>
  <script src="js/sunburst_plot.js"></script>
  <script src="js/sunburst_v2.js"></script>
  <script src="js/dropdown_filt.js"></script>
  <script src="js/vendor/modernizr-3.11.2.min.js"></script>
  <script src="js/plugins.js"></script>
  <!-- <script src="js/main.js"></script> -->
</head>

<body>
  <script>
    window.onload=function(){
      const pacbio_data = "https://tolqc.cog.sanger.ac.uk/pacbio/data.json"
      const main_data = "https://tolqc.cog.sanger.ac.uk/data.json"

      tolid_specify(pacbio_data);
      dategrapher(pacbio_data);
      species_sunburst(main_data);
      species_sunburst_2(main_data);
      filter(pacbio_data)
    }
  </script>

<div class="card-body">
  <div class="card-header"><h1>PacBio Yield Graphs </h1> <a class="nav-link" href="https://github.com/DLBPointon/tolqc-graph/issues"><i class="fas fa-greater-than"></i><span> GitHub Issue Page & Feature Tracking</span></a></li> </div>

  <div class="card-header"><h2>TolID Specific Yield</h2><span>All Data, searchable by TolID</span></div>

  <div id="tolid" style="height: 600px;"></div>

  <span style="font-family: Arial, Helvetica, sans-serif;"><center>As a note, labels are: `{ToL-ID} : {WELL-ID} : {RUN-ID} : {GROUP}`, this creates a unique ID.</center></span>

  <div class="card-header d-flex justify-content-between align-items-center">
    <h4 class="text-primary font-weight-bold m-0"> Data selectors </h4>
      <label for="tolgraph0T"></label>
      <h4 class="text-primary"> Filter: </h4>
        <input id='textInput' type="text" onchange="filter(pacbio_data)">
      <h4 class="text-primary"> Dropdown: </h4>
        <select id="tolgraph0T" onchange="tolid_specify(pacbio_data)"></select>
  </div>
  <div class="card-header d-flex justify-content-between align-items-center">
    <h4 class="text-primary font-weight-bold m-0"> Select overview or detailed </h4>
      <select id="datadetailed" onchange="tolid_specify(pacbio_data)">
        <option value="TRUE">
          Overview
        </option>
        <option style="font-size: 1px" value="FALSE" selected='selected'>
          Detailed
        </option>
      </select>
  </div>

  <div class="card-header d-flex justify-content-between align-items-center">
    <h4 class="text-primary font-weight-bold m-0"> Data Counter </h4>
    <div class="text-dark font-weight-bold h5 mb-0">
      <span id="datacounted"></span>
    </div>
  </div>

<script>
  let dropdown = document.getElementById('tolgraph0T');
  dropdown.length = 0;

  let defaultOption = document.createElement('option');
  defaultOption.text = 'All';
  defaultOption.value = 'True';

  dropdown.add(defaultOption);
  dropdown.selectedIndex = 0;
  let filteredData = []

  const pacbio_data = "https://tolqc.cog.sanger.ac.uk/pacbio/data.json"

  $.getJSON(pacbio_data, function(data) {
    data.forEach((item) => {
      if (!filteredData.includes(item['specimen'])) {
        filteredData.push(item['specimen'])
        option = document.createElement('option');
        option.text = item['specimen'];
        option.value = item['specimen'];
        dropdown.add(option);
        //console.log(item['specimen'])
      } else {
        //console.log('PASS')
      }
    });
  })
</script>

</div>
<div class="card-body">
  <div class="card-header"><h2>Customizable PacBio Yield Graphs </h2><span>All HiFi data, customizable</span></div>

  <div id="dategraphLoc" style="height: 600px;"></div>

    <div class="card-header d-flex justify-content-between align-items-center">
        <h4 class="text-primary font-weight-bold m-0"> Data selector </h4>
    <label for="tolgraph1T"></label>
    <select id="tolgraph1T" onchange="dategrapher(pacbio_data)">
      <option value="TRUE">
        Per Tag
      </option>
      <option value="FALSE" selected='selected'>
        Per SMRT cell
      </option>
    </select>
  </div>

  <div class="card-header d-flex justify-content-between align-items-center">
    <h4 class="text-primary font-weight-bold m-0"> Y Value</h4>
  <label for="tolgraph1Y"></label>
    <select id="tolgraph1Y" onchange="dategrapher(pacbio_data)">
      <option value="sum" selected='selected'>
          Base Pairs collected
      </option>
      <option value="N50">
          N50
      </option>
      <option value="n">
          N Percentage
      </option>
      <option value="a">
          AT percentage
      </option>
    </select>
  </div>

  <div class="card-header d-flex justify-content-between align-items-center">
    <h4 class="text-primary font-weight-bold m-0"> Colour by </h4>
  <label for="tolgraph1C"></label>
    <select id="tolgraph1C" onchange="dategrapher(pacbio_data)">
      <option value="Clade" selected='selected'>
          Clade
      </option>
      <option value="pipeline">
        Pipeline (CLR/CCS)
      </option>
      <option value="model">
          Machine Model
      </option>
      <option value="instrument">
          Machine Name
      </option>
    </select>
  </div>

  <div class="card-header d-flex justify-content-between align-items-center">
    <h4 class="text-primary font-weight-bold m-0"> Label with </h4>
  <label for="tolgraph1L"></label>
  <select id="tolgraph1L" onchange="dategrapher(pacbio_data)">
      <option value="species">
          Species Name
      </option>
      <option value="specimen" selected='selected'>
          TolID
      </option>
    </select>
  </div>
</div>

<div class="card-body">
  <div class="card-header"><h1>Plotly.js - Species Hierarchy Sunburst Plot </h1></div>
  <div style="height: 800px;" id="species_sunburst_plot"></div>
</div>

<div class="card-body">
  <div class="card-header"><h1>anycharts.js - Species Hierarchy Sunburst Plot 2 </h1></div>
  <div style="height: 800px;" id="species_sunburst_plot_2"></div>

</div>


</body>
</html>

<style>
  .card-body{-ms-flex:1 1 auto;flex:1 1 auto;min-height:1px;padding:1.25rem}
  .card-title{margin-bottom:.75rem}
  .card-text{margin-bottom:0}.card-link:hover{text-decoration:none}
  .card-header{font-family: Arial, Helvetica, sans-serif;padding:.75rem 1.25rem;margin-bottom:0;background-color:rgba(0,0,0,.03);border-bottom:1px solid rgba(0,0,0,.125)}
  .d-flex{display:-ms-flexbox!important;display:flex!important}
  .justify-content-between{-ms-flex-pack:justify!important;justify-content:space-between!important}
  .align-items-center{-ms-flex-align:center!important;align-items:center!important}
  .text-primary{font-family: Arial, Helvetica, sans-serif;color:#007bff!important}a.text-primary:focus,a.text-primary:hover{color:#0056b3!important}
  .m-0{margin:0!important}
  .text-dark{font-family: Arial, Helvetica, sans-serif;color:#343a40!important}a.text-dark:focus,a.text-dark:hover{color:#121416!important}

</style>